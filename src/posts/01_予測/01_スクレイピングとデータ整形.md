---
title: 'スクレイピング'
created: '2023/01/01'
update: '2023/02/01'
tags: 
    - 競馬予想
    - Python
---

PythonのPandasを使って競馬のデータ整形を行う方法についてご紹介します。

競馬予想には、豊富なデータが必要ですが、そのデータを手作業で入力するのは非効率ですよね。
そこで、有名な競馬情報サイトである[netkeiba](https://www.netkeiba.com/)からデータをスクレイピングし、
PythonのPandasを使って整形する方法を解説します。

まず、スクレイピングにはPythonのライブラリであるBeautifulSoupを使用します。
BeautifulSoupを使って、netkeibaのサイトからレース情報を取得しましょう。

``` python
import requests
from bs4 import BeautifulSoup

# レース情報のURL
url = "https://www.netkeiba.com/"

# ページの取得
response = requests.get(url)
html = response.content

# BeautifulSoupを使ってHTMLをパース
soup = BeautifulSoup(html, "html.parser")

# レース情報の要素を取得
race_info = soup.find_all("div", class_="race-info")

# レース情報の整形と表示
for info in race_info:
    race_name = info.find("span", class_="race_name").text
    race_date = info.find("span", class_="date").text
    print(race_name, race_date)
```

上記のコードでは、`requests`ライブラリを使ってnetkeibaのサイトにアクセスし、`BeautifulSoup`でHTMLをパースしています。`race_info`という変数には、レース情報が含まれています。

次に、取得したデータをPandasを使って整形します。Pandasはデータ解析や操作に優れたライブラリであり、競馬のデータ整形にも便利です。

```python
import pandas as pd

# 取得したデータを辞書型に格納
data = {
    "race_name": [],
    "race_date": []
}

# データの整形
for info in race_info:
    race_name = info.find("span", class_="race_name").text
    race_date = info.find("span", class_="date").text
    
    data["race_name"].append(race_name)
    data["race_date"].append(race_date)

# データフレームの作成
df = pd.DataFrame(data)

# データの表示
print(df)
```

上記のコードでは、辞書型を用意し、ループを回してデータを整形しています。最後に、`pd.DataFrame`を使ってデータフレームを作成し、整形したデータを表示しています。

これで、netkeibaから取得したレース情報を整形することができました。
