---
title: '予測結果の解析'
created: '2023/01/01'
update: '2023/06/01'
tags: 
    - 競馬予想
    - Python

---


前回の記事では、モデルの評価とパラメータチューニングの手順を解説しました。今回は、実際のレースデータを用いて予測を行い、予測結果の解析と改善方法の考察を行っていきましょう。

予測結果の解析を行うために、まずは新たなデータセットを用意します。netkeibaから取得したレース情報のうち、最新のデータを取得してください。データの整形は前回の記事で行った方法と同様に行ってください。

次に、モデルを使って予測を行います。以下のコードでは、新たなデータセットを使って予測を行い、予測結果を評価しています。

```python
# 新たなデータセットの読み込みと整形
new_df = pd.read_csv("new_data.csv")
new_df["race_distance"] = new_df["race_name"].apply(lambda x: int(x.split("m")[0]))
new_df["race_course"] = new_df["race_name"].apply(lambda x: x.split(" ")[-1])

# 特徴量の抽出
X_new = new_df[["race_distance", "race_course"]]

# 予測結果の取得
y_pred_new = model.predict(X_new)

# 予測結果の解析
predicted_probabilities = model.predict_proba(X_new)
class_probabilities = [prob[1] for prob in predicted_probabilities]

# 予測結果と確率の表示
new_df["predicted_result"] = y_pred_new
new_df["class_probability"] = class_probabilities
print(new_df[["race_name", "predicted_result", "class_probability"]])
```

上記のコードでは、新たなデータセットを読み込み、特徴量を抽出しています。そして、`predict`メソッドを使って予測結果を取得し、`predict_proba`メソッドを使って各クラスの確率を取得しています。

最後に、予測結果と確率を表示しています。これにより、各レースの予測結果とその確信度を確認することができます。予測結果と実際のレース結果を比較し、モデルの性能を評価することが重要です。

予測結果の解析に基づいて、モデルの改善方法を考察しましょう。予測が外れたケースや確信度が低い場合には、以下のような改善点が考えられます。


